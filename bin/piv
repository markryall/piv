#!/usr/bin/env ruby -wKU

$: << File.dirname(__FILE__)+'/../lib'

require 'yaml'

unless File.exist? '.piv'
  require 'piv'
  include Piv
  generate_project ARGV.shift, ARGV.shift
  exit
end

config = YAML.load_file '.piv'
config['flavours'].each do |flavour|
  require "piv/#{flavour}"
  include Piv.const_get flavour.classify
end

generator = ARGV.shift
method_name = "generate_#{generator}"
unless respond_to? method_name
   puts "Unknown generator #{generator}"
   exit 1  
end
self.send method_name, *ARGV 